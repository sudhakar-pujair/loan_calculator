<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>EMI Calculator</title>

  <link rel="stylesheet" href="style.css">

  <!-- SheetJS -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

  <!-- jsPDF + html2canvas -->
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
</head>
<body>

<div class="topbar">
  <div>
    <h1>EMI Calculator</h1>
    <p class="muted">Calculate EMI Schedule, Export Excel & PDF, View Charts</p>
  </div>

  <!-- Theme toggle -->
  <label class="switch">
    <input id="themeToggle" type="checkbox" />
    <span class="slider"></span>
  </label>
  <span class="theme-label" id="themeLabel">Light</span>
</div>

<main class="container">

  <!-- INPUT CARD -->
  <section class="card" id="inputCard">
    <form id="emiForm" class="form-row" autocomplete="off">

      <div class="form-group">
        <label>Principal (₹)</label>
        <input id="principal" type="number" placeholder="e.g. 1429094" />
        <div class="error" id="errPrincipal"></div>
      </div>

      <div class="form-group">
        <label>EMI (₹)</label>
        <input id="emi" type="number" placeholder="e.g. 100000" />
        <div class="error" id="errEmi"></div>
      </div>

      <div class="form-group">
        <label>Interest Rate (%)</label>
        <input id="rate" type="number" step="0.01" placeholder="e.g. 14" />
        <div class="error" id="errRate"></div>
      </div>

      <div class="actions">
        <button type="button" class="btn primary" id="calculate">Calculate</button>
        <button type="button" class="btn" id="downloadExcel">Download Excel</button>
        <button type="button" class="btn" id="downloadPdf">Download PDF</button>
      </div>

    </form>
  </section>

  <!-- SUMMARY CARD -->
  <section class="card" id="summaryCard">
    <div class="summary-grid">
      <div class="summary-item">
        <div class="label">Principal</div>
        <div class="value" id="r_principal">—</div>
      </div>

      <div class="summary-item">
        <div class="label">EMI</div>
        <div class="value" id="r_emi">—</div>
      </div>

      <div class="summary-item">
        <div class="label">Interest Rate</div>
        <div class="value" id="r_rate">—</div>
      </div>

      <div class="summary-item">
        <div class="label">Total Months</div>
        <div class="value" id="r_months">—</div>
      </div>

      <div class="summary-item">
        <div class="label">Total Interest Paid</div>
        <div class="value" id="r_interest">—</div>
      </div>

      <div class="summary-item">
        <div class="label">Total Principal Paid</div>
        <div class="value" id="r_total_principal">—</div>
      </div>
    </div>

    <div class="charts">
      <canvas id="balanceChart" height="160"></canvas>
      <canvas id="doughnutChart" height="160"></canvas>
    </div>
  </section>

  <!-- SCHEDULE CARD -->
  <section class="card" id="tableCard">
    <h3>EMI Schedule</h3>

    <div class="table-wrap" id="pdfContent">
      <table id="scheduleTable">
        <thead>
          <tr>
            <th>Month</th>
            <th>Opening Principal</th>
            <th>EMI</th>
            <th>Principal Repaid</th>
            <th>Interest</th>
            <th>Closing Principal</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

  </section>

</main>

<script src="script.js"></script>

</body>
</html>
